<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Multivariate Stats</title>
  <meta name="description" content="The captain’s log of Multivariate Stats">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Multivariate Stats" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The captain’s log of Multivariate Stats" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Multivariate Stats" />
  
  <meta name="twitter:description" content="The captain’s log of Multivariate Stats" />
  

<meta name="author" content="Tiago dos Santos">


<meta name="date" content="2018-11-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="lesson-7.html">
<link rel="next" href="studies-experiments.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.9/d3.min.js"></script>
<link href="libs/d3scatter-0.0.0/d3scatter.css" rel="stylesheet" />
<script src="libs/d3scatter-0.0.0/d3scatter.js"></script>
<script src="libs/d3scatter-binding-0.1.0/d3scatter.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.2/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.2/js/bootstrap.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Lesson 2</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#random-variables-and-vectors"><i class="fa fa-check"></i><b>1.1</b> Random Variables and Vectors</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#elements-of-probability"><i class="fa fa-check"></i><b>1.1.1</b> Elements of probability</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#section"><i class="fa fa-check"></i><b>1.1.2</b> </a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#variance-and-corrected-variance"><i class="fa fa-check"></i><b>1.2</b> Variance and Corrected Variance</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#variance"><i class="fa fa-check"></i><b>1.2.1</b> Variance</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#corrected-variance"><i class="fa fa-check"></i><b>1.2.2</b> Corrected Variance</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#covariance"><i class="fa fa-check"></i><b>1.2.3</b> Covariance</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>1.2.4</b> Pearson Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lesson-3.html"><a href="lesson-3.html"><i class="fa fa-check"></i><b>2</b> Lesson 3</a><ul>
<li class="chapter" data-level="2.0.1" data-path="lesson-3.html"><a href="lesson-3.html#estatsticas-ordinais"><i class="fa fa-check"></i><b>2.0.1</b> Estat??sticas Ordinais</a></li>
<li class="chapter" data-level="2.0.2" data-path="lesson-3.html"><a href="lesson-3.html#transforming-to-distance-slide-27"><i class="fa fa-check"></i><b>2.0.2</b> Transforming to Distance (slide 27)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lesson-4.html"><a href="lesson-4.html"><i class="fa fa-check"></i><b>3</b> Lesson 4</a><ul>
<li class="chapter" data-level="3.1" data-path="lesson-4.html"><a href="lesson-4.html#slide-9-exercice"><i class="fa fa-check"></i><b>3.1</b> Slide 9 exercice</a></li>
<li class="chapter" data-level="3.2" data-path="lesson-4.html"><a href="lesson-4.html#slide-10-exercise"><i class="fa fa-check"></i><b>3.2</b> Slide 10 exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lesson-5.html"><a href="lesson-5.html"><i class="fa fa-check"></i><b>4</b> Lesson 5</a><ul>
<li class="chapter" data-level="4.1" data-path="lesson-5.html"><a href="lesson-5.html#anova"><i class="fa fa-check"></i><b>4.1</b> ANOVA</a></li>
<li class="chapter" data-level="4.2" data-path="lesson-5.html"><a href="lesson-5.html#adding-the-samples-column"><i class="fa fa-check"></i><b>4.2</b> Adding the Samples column</a></li>
<li class="chapter" data-level="4.3" data-path="lesson-5.html"><a href="lesson-5.html#exercicio-2"><i class="fa fa-check"></i><b>4.3</b> Exercicio 2</a></li>
<li class="chapter" data-level="4.4" data-path="lesson-5.html"><a href="lesson-5.html#manova"><i class="fa fa-check"></i><b>4.4</b> Manova</a></li>
<li class="chapter" data-level="4.5" data-path="lesson-5.html"><a href="lesson-5.html#avaliar-a-homocedasticidade-das-variaveis"><i class="fa fa-check"></i><b>4.5</b> avaliar a Homocedasticidade das variáveis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lesson-6.html"><a href="lesson-6.html"><i class="fa fa-check"></i><b>5</b> Lesson 6</a><ul>
<li class="chapter" data-level="5.1" data-path="lesson-6.html"><a href="lesson-6.html#avaliar-a-homocedasticidade-das-variaveis-1"><i class="fa fa-check"></i><b>5.1</b> avaliar a Homocedasticidade das variáveis</a></li>
<li class="chapter" data-level="5.2" data-path="lesson-6.html"><a href="lesson-6.html#contrast-matrix"><i class="fa fa-check"></i><b>5.2</b> Contrast Matrix</a></li>
<li class="chapter" data-level="5.3" data-path="lesson-6.html"><a href="lesson-6.html#discriminant-analysis"><i class="fa fa-check"></i><b>5.3</b> Discriminant Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lesson-7.html"><a href="lesson-7.html"><i class="fa fa-check"></i><b>6</b> Lesson 7</a><ul>
<li class="chapter" data-level="6.1" data-path="lesson-7.html"><a href="lesson-7.html#analise-de-discriminantes"><i class="fa fa-check"></i><b>6.1</b> Análise de Discriminantes</a></li>
<li class="chapter" data-level="6.2" data-path="lesson-7.html"><a href="lesson-7.html#pca"><i class="fa fa-check"></i><b>6.2</b> PCA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lesson-8.html"><a href="lesson-8.html"><i class="fa fa-check"></i><b>7</b> Lesson 8</a><ul>
<li class="chapter" data-level="7.0.1" data-path="lesson-8.html"><a href="lesson-8.html#aplying-the-maunchly-test-sphericity-test"><i class="fa fa-check"></i><b>7.0.1</b> Aplying the Maunchly Test / Sphericity Test</a></li>
<li class="chapter" data-level="7.0.2" data-path="lesson-8.html"><a href="lesson-8.html#now-automated-with-r-code"><i class="fa fa-check"></i><b>7.0.2</b> Now automated with R code</a></li>
<li class="chapter" data-level="7.1" data-path="lesson-8.html"><a href="lesson-8.html#interpreting-principal-components"><i class="fa fa-check"></i><b>7.1</b> Interpreting Principal Components</a></li>
<li class="chapter" data-level="7.2" data-path="lesson-8.html"><a href="lesson-8.html#exercise"><i class="fa fa-check"></i><b>7.2</b> Exercise</a><ul>
<li class="chapter" data-level="7.2.1" data-path="lesson-8.html"><a href="lesson-8.html#which-pc-do-i-choose-what-is-the-percentage-of-variability-explained-by-each-pc"><i class="fa fa-check"></i><b>7.2.1</b> Which PC do I choose? What is the percentage of variability explained by each PC?</a></li>
<li class="chapter" data-level="7.2.2" data-path="lesson-8.html"><a href="lesson-8.html#how-to-interpret-the-principal-component"><i class="fa fa-check"></i><b>7.2.2</b> How to interpret the Principal Component?</a></li>
<li class="chapter" data-level="7.2.3" data-path="lesson-8.html"><a href="lesson-8.html#suitability-analysis"><i class="fa fa-check"></i><b>7.2.3</b> Suitability analysis</a></li>
<li class="chapter" data-level="7.2.4" data-path="lesson-8.html"><a href="lesson-8.html#calculate-scores"><i class="fa fa-check"></i><b>7.2.4</b> Calculate scores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="studies-experiments.html"><a href="studies-experiments.html"><i class="fa fa-check"></i><b>8</b> Studies &amp; Experiments</a><ul>
<li class="chapter" data-level="8.1" data-path="studies-experiments.html"><a href="studies-experiments.html#matrixes-span-and-determinantes"><i class="fa fa-check"></i><b>8.1</b> Matrixes’ Span and Determinantes</a><ul>
<li class="chapter" data-level="8.1.1" data-path="studies-experiments.html"><a href="studies-experiments.html#more-that-3d"><i class="fa fa-check"></i><b>8.1.1</b> More that 3D</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="studies-experiments.html"><a href="studies-experiments.html#eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>8.2</b> EigenValues and EigenVectors</a><ul>
<li class="chapter" data-level="8.2.1" data-path="studies-experiments.html"><a href="studies-experiments.html#eigen-values"><i class="fa fa-check"></i><b>8.2.1</b> Eigen Values</a></li>
<li class="chapter" data-level="8.2.2" data-path="studies-experiments.html"><a href="studies-experiments.html#eigen-vectores"><i class="fa fa-check"></i><b>8.2.2</b> Eigen Vectores</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="studies-experiments.html"><a href="studies-experiments.html#spectral-decomposition"><i class="fa fa-check"></i><b>8.3</b> Spectral Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>9</b> Exercises</a></li>
<li class="chapter" data-level="10" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>10</b> Exercise</a><ul>
<li class="chapter" data-level="10.1" data-path="exercise-1.html"><a href="exercise-1.html#exercise-1---linear-algebra"><i class="fa fa-check"></i><b>10.1</b> Exercise 1 - Linear Algebra</a><ul>
<li class="chapter" data-level="10.1.1" data-path="exercise-1.html"><a href="exercise-1.html#ex-1"><i class="fa fa-check"></i><b>10.1.1</b> Ex 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="exercise-1.html"><a href="exercise-1.html#ex-2"><i class="fa fa-check"></i><b>10.1.2</b> Ex 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="exercise-1.html"><a href="exercise-1.html#ex-3"><i class="fa fa-check"></i><b>10.1.3</b> Ex 3</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exercise-1.html"><a href="exercise-1.html#section-1"><i class="fa fa-check"></i><b>10.2</b> </a></li>
<li class="chapter" data-level="10.3" data-path="exercise-1.html"><a href="exercise-1.html#section-2"><i class="fa fa-check"></i><b>10.3</b> 11</a></li>
<li class="chapter" data-level="10.4" data-path="exercise-1.html"><a href="exercise-1.html#section-3"><i class="fa fa-check"></i><b>10.4</b> 12</a></li>
<li class="chapter" data-level="10.5" data-path="exercise-1.html"><a href="exercise-1.html#section-4"><i class="fa fa-check"></i><b>10.5</b> 13</a></li>
<li class="chapter" data-level="10.6" data-path="exercise-1.html"><a href="exercise-1.html#section-5"><i class="fa fa-check"></i><b>10.6</b> 14</a></li>
<li class="chapter" data-level="10.7" data-path="exercise-1.html"><a href="exercise-1.html#section-6"><i class="fa fa-check"></i><b>10.7</b> 15</a></li>
<li class="chapter" data-level="10.8" data-path="exercise-1.html"><a href="exercise-1.html#section-7"><i class="fa fa-check"></i><b>10.8</b> 16</a></li>
<li class="chapter" data-level="10.9" data-path="exercise-1.html"><a href="exercise-1.html#section-8"><i class="fa fa-check"></i><b>10.9</b> 17</a></li>
<li class="chapter" data-level="10.10" data-path="exercise-1.html"><a href="exercise-1.html#section-9"><i class="fa fa-check"></i><b>10.10</b> 18</a></li>
<li class="chapter" data-level="10.11" data-path="exercise-1.html"><a href="exercise-1.html#section-10"><i class="fa fa-check"></i><b>10.11</b> 19</a></li>
<li class="chapter" data-level="10.12" data-path="exercise-1.html"><a href="exercise-1.html#section-11"><i class="fa fa-check"></i><b>10.12</b> 24</a></li>
<li class="chapter" data-level="10.13" data-path="exercise-1.html"><a href="exercise-1.html#section-12"><i class="fa fa-check"></i><b>10.13</b> 25</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate Stats</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lesson-8" class="section level1">
<h1><span class="header-section-number">7</span> Lesson 8</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dados8 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="kw">file.path</span>(datasetsDir, <span class="st">&quot;data8.xlsx&quot;</span>)))
footpca&lt;-<span class="kw">prcomp</span>(<span class="dt">x =</span> dados8,<span class="dt">scale. =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(footpca)</code></pre></div>
<pre><code>## Importance of components:
##                          PC1    PC2    PC3    PC4     PC5     PC6
## Standard deviation     1.602 1.1699 0.9663 0.8234 0.56646 0.36191
## Proportion of Variance 0.428 0.2281 0.1556 0.1130 0.05348 0.02183
## Cumulative Proportion  0.428 0.6561 0.8117 0.9247 0.97817 1.00000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(footpca)</code></pre></div>
<pre><code>## $names
## [1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;       
## 
## $class
## [1] &quot;prcomp&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(footpca<span class="op">$</span>rotation,<span class="dv">3</span>)</code></pre></div>
<pre><code>##           PC1    PC2    PC3    PC4    PC5    PC6
## WDIM   -0.510  0.007 -0.447  0.033  0.625 -0.386
## CIRCUM -0.561 -0.086  0.321 -0.022  0.221  0.725
## FBEYE  -0.463  0.146  0.475 -0.471 -0.307 -0.472
## EYEHD  -0.143 -0.664  0.313  0.594 -0.091 -0.282
## EARHD  -0.109 -0.645 -0.468 -0.489 -0.313  0.127
## JAW    -0.422  0.338 -0.393  0.431 -0.601  0.083</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">screeplot</span>(footpca,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Scree plot&quot;</span>)</code></pre></div>
<p><img src="Multivariate_Stats_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cbinded_data_pcs &lt;-<span class="st"> </span>crosstalk<span class="op">::</span>SharedData<span class="op">$</span><span class="kw">new</span>(<span class="kw">cbind.data.frame</span>(<span class="kw">as.data.frame</span>(dados8.scaled), <span class="kw">as.data.frame</span>(footpca<span class="op">$</span>x)))

crosstalk<span class="op">::</span><span class="kw">bscols</span>(
  d3scatter<span class="op">::</span><span class="kw">d3scatter</span>(cbinded_data_pcs, <span class="op">~</span>WDIM, <span class="op">~</span>CIRCUM, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,<span class="dt">width=</span><span class="st">&quot;100%&quot;</span>, <span class="dt">height=</span><span class="dv">300</span>),
  d3scatter<span class="op">::</span><span class="kw">d3scatter</span>(cbinded_data_pcs, <span class="op">~</span>PC1, <span class="op">~</span>PC2, <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>,<span class="dt">width=</span><span class="st">&quot;100%&quot;</span>, <span class="dt">height=</span><span class="dv">300</span>)
)</code></pre></div>
<div class="container-fluid crosstalk-bscols">
<div class="fluid-row">
<div class="col-xs-6">
<div id="htmlwidget-ff1eea1e9aa61e96e492" style="width:100%;height:300px;" class="d3scatter html-widget"></div>
<script type="application/json" data-for="htmlwidget-ff1eea1e9aa61e96e492">{"x":{"data":{"x":[0,-0.164361345865297,-0.657445383461191,-1.97233615038357,-1.15052942105708,-0.493084037595894,-0.164361345865297,1.31489076692238,0,-0.821806729326488,0,0,0.328722691730594,-1.80797480451827,-0.986168075191785,1.64361345865298,0,-0.328722691730594,-1.64361345865298,0,-0.493084037595894,-0.328722691730594,-0.328722691730594,0.493084037595894,-1.15052942105708,-0.493084037595894,0.657445383461191,0,1.64361345865298,2.95850422557536,-0.986168075191785,-0.164361345865297,-0.328722691730594,-1.47925211278768,1.15052942105708,-1.47925211278768,0.657445383461191,-1.31489076692238,0,0.986168075191788,-0.493084037595894,-0.657445383461191,0.657445383461191,0.986168075191788,0.328722691730594,-0.328722691730594,-0.328722691730594,-0.493084037595894,1.80797480451828,0,0.493084037595894,0.821806729326488,-0.164361345865297,0.821806729326488,-0.164361345865297,0.493084037595894,-0.164361345865297,0,0.328722691730594,2.95850422557536],"y":[1.48580563683548,1.3016148554096,1.3016148554096,-0.417499104565342,0.257867093996242,-0.0491175417135686,0.257867093996242,0.257867093996242,-0.356102177423379,-0.66308681313319,-0.233308323139453,-0.66308681313319,-0.0491175417135686,-0.356102177423379,-1.70683457454655,1.36301178255156,-0.908674521701037,-1.58404072026262,-1.21565915741085,-0.66308681313319,-1.58404072026262,-0.66308681313319,-0.478896031707305,-1.27705608455281,-0.356102177423379,-0.417499104565342,0.749042511131937,-0.171911395997495,0.257867093996242,3.0821257425265,-0.66308681313319,-0.0491175417135686,-1.33845301169477,-0.970071448843,-0.66308681313319,0.257867093996242,-0.540292958849264,-1.09286530312693,0.564851729706052,1.48580563683548,0.135073239712316,-0.970071448843,1.36301178255156,0.0736763125703573,0.687645583989978,-0.417499104565342,-0.417499104565342,0.257867093996242,1.05602714684175,0.380660948280168,-0.0491175417135686,-0.233308323139453,-0.356102177423379,0.994630219699789,0.0122793854283943,1.66999641826137,-1.58404072026262,0.503454802564089,0.871836365415863,2.52955339824884],"key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"]},"color_spec":{"type":"constant","value":"blue"},"color":"blue","x_label":"WDIM","y_label":"CIRCUM","x_lim":null,"y_lim":null,"group":"SharedData492ca47a"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="col-xs-6">
<div id="htmlwidget-917e765c7c6febe0f95d" style="width:100%;height:300px;" class="d3scatter html-widget"></div>
<script type="application/json" data-for="htmlwidget-917e765c7c6febe0f95d">{"x":{"data":{"x":[-2.05678606740074,-0.768234905615184,-1.01907348764798,2.47777513310274,0.86352927542893,1.71707055589186,-0.602367734140102,-1.48524294909684,0.346559069370141,0.707971684524183,-0.445655382690665,0.410486564506743,-0.600220682898081,0.57306984743266,2.66379672086879,-2.0960867820476,0.709024430518506,1.7627094000304,2.04621201446252,0.616537460695302,1.41131525519511,1.30271789627948,0.572852500367583,0.704438769491233,1.58513929623174,1.66601008347363,-1.27993911993309,-0.394470162846524,-1.70297866002687,-5.09419894290294,0.832752172718894,0.564502744940302,1.74972740106694,2.06364100961747,-0.211103437942383,0.556150553847929,0.273095544132939,2.42036225832127,-0.147953862184186,-1.94637459573351,0.487861084740103,2.01442202149832,-1.47733853730542,-0.16136184469945,-0.836397697448007,0.388552899843271,0.449900756221412,-0.602610642082182,-2.09392974189398,-0.484046342726861,0.123337214409803,-0.462020851869494,0.480092648692218,-1.92081360225276,0.333182130056597,-2.23204476362156,2.3380377704009,-0.599255969567341,-1.77370036065197,-4.7186270411542],"y":[0.742640252048824,-2.51637644516981,-0.866335789553619,-0.796133356015138,2.71578571347943,0.489500775739017,1.09385745986381,2.12790414437577,-0.350458286599863,-0.710393844095895,0.160262874604498,1.68342149425893,0.573547691906571,1.3789100854313,-1.06609386360642,0.11276353455548,0.474671118844867,-0.553910070989594,-0.0914939209965231,0.373877977631258,-0.387538541032567,1.33130152463129,0.371405889042173,2.20982135730764,-0.525446450718391,0.510994154237273,1.26999387418722,0.346062287667243,1.29774686481492,0.580360008235145,2.48735776087013,-0.48514026823722,0.458785935491656,2.40584083899257,-1.43915290430268,-1.43235675581787,0.802468981652518,-1.17474053501495,-0.49828799332452,0.0169812206077286,-0.144528009185303,0.132508392729938,-1.02078428841413,-0.0959556768708949,-0.657926485210041,0.200084785544638,0.0450316620956515,-1.63189585926476,-1.73803604289107,-0.777951068827196,-1.97422976376342,-0.357692509198035,-1.07595882907093,0.182702017072992,-0.278326445799505,-0.661403723577937,-1.3991144726874,-2.41673492423717,0.209300801716102,0.338505644836203],"key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"]},"color_spec":{"type":"constant","value":"green"},"color":"green","x_label":"PC1","y_label":"PC2","x_lim":null,"y_lim":null,"group":"SharedData492ca47a"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dados8.scaled.df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(dados8.scaled)

S &lt;-<span class="st"> </span><span class="kw">cov</span>(dados8.scaled.df)

S<span class="op">&gt;=</span><span class="fl">0.5</span> <span class="co"># we have (p^2 - p)/2 distinct correlations, and just 3 of them are &gt;= 0.5</span></code></pre></div>
<pre><code>##         WDIM CIRCUM FBEYE EYEHD EARHD   JAW
## WDIM    TRUE   TRUE FALSE FALSE FALSE  TRUE
## CIRCUM  TRUE   TRUE  TRUE FALSE FALSE FALSE
## FBEYE  FALSE   TRUE  TRUE FALSE FALSE FALSE
## EYEHD  FALSE  FALSE FALSE  TRUE FALSE FALSE
## EARHD  FALSE  FALSE FALSE FALSE  TRUE FALSE
## JAW     TRUE  FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pcor &lt;-<span class="st"> </span>corpcor<span class="op">::</span><span class="kw">cor2pcor</span>(S) <span class="co"># this is the parcial correlation between variables excluding the influence of all the others</span>
<span class="co"># the values must be interpreted as the percentage of variability left explained by removing the influence of all the other variables</span></code></pre></div>
<div id="aplying-the-maunchly-test-sphericity-test" class="section level3">
<h3><span class="header-section-number">7.0.1</span> Aplying the Maunchly Test / Sphericity Test</h3>
<ul>
<li>We assume that the vector is normal multivariate</li>
<li>the test stats is <span class="math display">\[
  U^* = -\left(n-1-\frac{2p^2 + p + 2}{6p}\right)ln(U)
\]</span> <span class="math display">\[
  U = \Lambda^{2/n}
\]</span> <span class="math display">\[
  \Lambda = \frac{|S|^{n/2}}{(tr(S)/p)^{np/2}}
\]</span></li>
</ul>
<p>And therefore:</p>
<p><span class="math display">\[
  U = \frac{p^p|S|}{(tr(S))^p}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S.det &lt;-<span class="st"> </span><span class="kw">det</span>(S)
S.tr &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">tr</span>(S)
p &lt;-<span class="st"> </span><span class="kw">dim</span>(S)[<span class="dv">2</span>]
n &lt;-<span class="st"> </span><span class="kw">dim</span>(dados8)[<span class="dv">1</span>]

U =<span class="st"> </span>((p<span class="op">^</span>p)<span class="op">*</span>S.det) <span class="op">/</span><span class="st"> </span>(S.tr<span class="op">^</span>p)

Lambda &lt;-<span class="st"> </span>(S.det<span class="op">^</span>(n<span class="op">/</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>((S.tr<span class="op">/</span>p)<span class="op">^</span>(n<span class="op">*</span>p<span class="op">/</span><span class="dv">2</span>))
Lambda<span class="op">^</span>(<span class="dv">2</span><span class="op">/</span>n)</code></pre></div>
<pre><code>## [1] 0.09350695</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ustar &lt;-<span class="st"> </span><span class="op">-</span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span>p))<span class="op">*</span><span class="kw">log</span>(U)

## Chi sqrt degrees of freedom
chisqrt.degreesfreedom &lt;-<span class="st"> </span>(p<span class="op">*</span>(p<span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span></code></pre></div>
<p>What’s the probability of U* to be greather than 134.547?</p>
<p>P(U* &gt; 134.547)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(Ustar, chisqrt.degreesfreedom)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>And therefore we reject H0. This means that there is at least one correlation that is significantly differente than 0.</p>
</div>
<div id="now-automated-with-r-code" class="section level3">
<h3><span class="header-section-number">7.0.2</span> Now automated with R code</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mauchly.test</span>(<span class="kw">lm</span>(dados8.scaled<span class="op">~</span><span class="dv">1</span>))</code></pre></div>
<pre><code>## 
##  Mauchly&#39;s test of sphericity
## 
## data:  SSD matrix from lm(formula = dados8.scaled ~ 1)
## W = 0.093507, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="interpreting-principal-components" class="section level2">
<h2><span class="header-section-number">7.1</span> Interpreting Principal Components</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">correlation &lt;-<span class="st"> </span>footpca<span class="op">$</span>sdev <span class="op">*</span><span class="st"> </span>footpca<span class="op">$</span>rotation
cor.sq &lt;-<span class="st"> </span>correlation<span class="op">^</span><span class="dv">2</span>
<span class="kw">round</span>(cor.sq,<span class="dv">2</span>)</code></pre></div>
<pre><code>##         PC1  PC2  PC3  PC4  PC5  PC6
## WDIM   0.67 0.00 0.51 0.00 1.00 0.38
## CIRCUM 0.43 0.01 0.14 0.00 0.07 0.72
## FBEYE  0.20 0.02 0.21 0.21 0.09 0.21
## EYEHD  0.01 0.30 0.07 0.24 0.01 0.05
## EARHD  0.00 0.13 0.07 0.08 0.03 0.01
## JAW    0.02 0.01 0.02 0.02 0.05 0.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>((footpca<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>p,<span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.43 0.23 0.16 0.11 0.05 0.02</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">biplot</span>(footpca,<span class="dt">cex=</span><span class="fl">0.6</span>)</code></pre></div>
<p><img src="Multivariate_Stats_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">7.2</span> Exercise</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(MASS<span class="op">::</span>crabs,<span class="dv">6</span>)</code></pre></div>
<pre><code>##   sp sex index   FL  RW   CL   CW  BD
## 1  B   M     1  8.1 6.7 16.1 19.0 7.0
## 2  B   M     2  8.8 7.7 18.1 20.8 7.4
## 3  B   M     3  9.2 7.8 19.0 22.4 7.7
## 4  B   M     4  9.6 7.9 20.1 23.1 8.2
## 5  B   M     5  9.8 8.0 20.3 23.0 8.2
## 6  B   M     6 10.8 9.0 23.0 26.5 9.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(MASS<span class="op">::</span>crabs)</code></pre></div>
<pre><code>##  sp      sex         index            FL              RW       
##  B:100   F:100   Min.   : 1.0   Min.   : 7.20   Min.   : 6.50  
##  O:100   M:100   1st Qu.:13.0   1st Qu.:12.90   1st Qu.:11.00  
##                  Median :25.5   Median :15.55   Median :12.80  
##                  Mean   :25.5   Mean   :15.58   Mean   :12.74  
##                  3rd Qu.:38.0   3rd Qu.:18.05   3rd Qu.:14.30  
##                  Max.   :50.0   Max.   :23.10   Max.   :20.20  
##        CL              CW              BD       
##  Min.   :14.70   Min.   :17.10   Min.   : 6.10  
##  1st Qu.:27.27   1st Qu.:31.50   1st Qu.:11.40  
##  Median :32.10   Median :36.80   Median :13.90  
##  Mean   :32.11   Mean   :36.41   Mean   :14.03  
##  3rd Qu.:37.23   3rd Qu.:42.00   3rd Qu.:16.60  
##  Max.   :47.60   Max.   :54.60   Max.   :21.60</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crabs.prcomp &lt;-<span class="st"> </span><span class="kw">prcomp</span>(MASS<span class="op">::</span>crabs[,<span class="op">-</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="dt">scale. =</span> <span class="ot">TRUE</span>)

crabs.prcomp.variance &lt;-<span class="st"> </span>crabs.prcomp<span class="op">$</span>sdev<span class="op">^</span><span class="dv">2</span>
crabs.eigenValues.cumsum &lt;-<span class="st"> </span><span class="kw">cumsum</span>(crabs.prcomp.variance)

crabs.eigen.df =<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">CP =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(crabs.eigenValues.cumsum),
  <span class="dt">EV=</span> <span class="kw">round</span>(crabs.prcomp.variance,<span class="dv">3</span>),
  <span class="dt">Prop_cum =</span> crabs.eigenValues.cumsum<span class="op">/</span><span class="kw">sum</span>(crabs.prcomp.variance)
)</code></pre></div>
<div id="which-pc-do-i-choose-what-is-the-percentage-of-variability-explained-by-each-pc" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Which PC do I choose? What is the percentage of variability explained by each PC?</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotly<span class="op">::</span><span class="kw">subplot</span>(
  plotly<span class="op">::</span><span class="kw">plot_ly</span>(
    crabs.eigen.df, <span class="dt">x=</span><span class="op">~</span>CP, <span class="dt">y=</span><span class="op">~</span>EV, <span class="dt">type=</span><span class="st">&quot;scatter&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;lines+markers&quot;</span>, <span class="dt">name=</span><span class="st">&quot;Scree Plot&quot;</span>
  ),
  plotly<span class="op">::</span><span class="kw">plot_ly</span>(
    crabs.eigen.df, <span class="dt">x=</span><span class="op">~</span>CP, <span class="dt">y=</span><span class="op">~</span>Prop_cum, <span class="dt">type=</span><span class="st">&quot;scatter&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;lines+markers&quot;</span>, <span class="dt">name=</span><span class="st">&quot;Cum Importance&quot;</span>
  )
)</code></pre></div>
<div id="htmlwidget-5e0518049d89309b5e36" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e0518049d89309b5e36">{"x":{"data":[{"x":[1,2,3,4,5],"y":[4.789,0.152,0.047,0.011,0.002],"mode":"lines+markers","name":"Scree Plot","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5],"y":[0.957766956872297,0.988103998221337,0.99743059303938,0.999657664468869,1],"mode":"lines+markers","name":"Cum Importance","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.48],"automargin":true,"anchor":"y"},"xaxis2":{"domain":[0.52,1],"automargin":true,"anchor":"y2"},"yaxis2":{"domain":[0,1],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0,1],"automargin":true,"anchor":"x"},"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true},"attrs":{"b674423445e2":{"x":{},"y":{},"mode":"lines+markers","name":"Scree Plot","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"b67475d81a62":{"x":{},"y":{},"mode":"lines+markers","name":"Cum Importance","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<div id="criterias-to-choose-the-pcs" class="section level4">
<h4><span class="header-section-number">7.2.1.1</span> Criterias to choose the PCs</h4>
<ul>
<li>Maintain PCs up until 80% variability explained</li>
<li></li>
</ul>
</div>
</div>
<div id="how-to-interpret-the-principal-component" class="section level3">
<h3><span class="header-section-number">7.2.2</span> How to interpret the Principal Component?</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corr_between_pc_vars &lt;-<span class="st"> </span>(crabs.prcomp<span class="op">$</span>rotation<span class="op">*</span>crabs.prcomp<span class="op">$</span>sdev)
<span class="kw">round</span>(corr_between_pc_vars[,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>,<span class="dv">3</span>)</code></pre></div>
<pre><code>##    FL    RW    CL    CW    BD 
## 0.979 0.028 0.010 0.002 0.000</code></pre>
</div>
<div id="suitability-analysis" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Suitability analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crabs.scaled &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">scale</span>(MASS<span class="op">::</span>crabs[,<span class="op">-</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>)], <span class="dt">center=</span><span class="ot">TRUE</span>,<span class="dt">scale=</span><span class="ot">TRUE</span>))

S &lt;-<span class="st"> </span><span class="kw">cov</span>(crabs.scaled)

S<span class="op">&gt;=</span><span class="fl">0.5</span> <span class="co"># we have (p^2 - p)/2 distinct correlations, and just 3 of them are &gt;= 0.5</span></code></pre></div>
<pre><code>##      FL   RW   CL   CW   BD
## FL TRUE TRUE TRUE TRUE TRUE
## RW TRUE TRUE TRUE TRUE TRUE
## CL TRUE TRUE TRUE TRUE TRUE
## CW TRUE TRUE TRUE TRUE TRUE
## BD TRUE TRUE TRUE TRUE TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">carb.partial.cor &lt;-<span class="st"> </span>corpcor<span class="op">::</span><span class="kw">cor2pcor</span>(S) 
carb.partial.cor</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]        [,5]
## [1,]  1.0000000  0.44626384  0.3359484 -0.2903388  0.47432971
## [2,]  0.4462638  1.00000000 -0.4444670  0.5002060  0.08379555
## [3,]  0.3359484 -0.44446701  1.0000000  0.9542583  0.52966607
## [4,] -0.2903388  0.50020598  0.9542583  1.0000000 -0.40540239
## [5,]  0.4743297  0.08379555  0.5296661 -0.4054024  1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the values must be interpreted as the percentage of variability left explained by removing the influence of all the other variables</span></code></pre></div>
<p>The values must be interpreted as the percentage of variability left explained by removing the influence of all the other variables</p>
<div id="sphericity-test" class="section level4">
<h4><span class="header-section-number">7.2.3.1</span> Sphericity Test</h4>
<p>Our <span class="math inline">\(H_0\)</span> is that our correlation matrix is equal to the Identity matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S.det &lt;-<span class="st"> </span><span class="kw">det</span>(S)
S.tr &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw">tr</span>(S)
p &lt;-<span class="st"> </span><span class="kw">dim</span>(S)[<span class="dv">2</span>]
n &lt;-<span class="st"> </span><span class="kw">nrow</span>(MASS<span class="op">::</span>crabs)

U =<span class="st"> </span>((p<span class="op">^</span>p)<span class="op">*</span>S.det) <span class="op">/</span><span class="st"> </span>(S.tr<span class="op">^</span>p)

Lambda &lt;-<span class="st"> </span>(S.det<span class="op">^</span>(n<span class="op">/</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>((S.tr<span class="op">/</span>p)<span class="op">^</span>(n<span class="op">*</span>p<span class="op">/</span><span class="dv">2</span>))
Lambda<span class="op">^</span>(<span class="dv">2</span><span class="op">/</span>n)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ustar &lt;-<span class="st"> </span><span class="op">-</span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span>p))<span class="op">*</span><span class="kw">log</span>(U)

## Chi sqrt degrees of freedom
chisqrt.degreesfreedom &lt;-<span class="st"> </span>(p<span class="op">*</span>(p<span class="op">+</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span>

<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(Ustar, chisqrt.degreesfreedom)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>If done my the R function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mauchly.test</span>(<span class="kw">lm</span>(<span class="kw">as.matrix</span>(crabs.scaled)<span class="op">~</span><span class="dv">1</span>))</code></pre></div>
<pre><code>## 
##  Mauchly&#39;s test of sphericity
## 
## data:  SSD matrix from lm(formula = as.matrix(crabs.scaled) ~ 1)
## W = 6.4564e-07, p-value &lt; 2.2e-16</code></pre>
<p>By rejecting <span class="math inline">\(H_0\)</span> we are saying that the are correlations that are significatively different from 0.</p>
</div>
</div>
<div id="calculate-scores" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Calculate scores</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crabs.scores &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(MASS<span class="op">::</span>crabs[,<span class="op">-</span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">3</span>)]) <span class="op">%*%</span><span class="st"> </span>crabs.prcomp<span class="op">$</span>rotation</code></pre></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lesson-7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="studies-experiments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
